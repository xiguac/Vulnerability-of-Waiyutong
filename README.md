外语通口语练习平台漏洞记录  
平台链接：https://www.waiyutong.org  
  
`注意：本仓库仅记录口语识别部分（核心功能）漏洞，其余部分不做记录`  
识别流程：  
1,[添加识别任务] POST方式发送到https://asr.waiyutong.org/Mp3/newAsr.html ，发送需要识别的语句，例如需要识别hello world，则向https://asr.waiyutong.org/Mp3/newAsr.html POST发送`{"apiVersion":"1.0.1","type":2,"content":"hello world"}`。接收到的返回数据（示例）为`{"status":"1","id":"00000000001234567890","server_no":"FE-A-7"}`，其中id在获取识别结果时使用。  

2,[上传文件] 在请求头中添加`Pcm-Data {"apiVersion":"1.0.1","id":"00000000001234567890","index":1}`，POST方式发送音频数据到https://asr.waiyutong.org/Mp3/uploadMp3.html ，因本人不熟悉js，固此步操作无法详细说明（使用到的相关js已同步上传至仓库）。接受到的返回数据（示例）为`{"status":"1","id":"00000000001234567890","name":"1234567890-1.mp3","server_no":"FE-A-7"}`，其中name为音频文件名，获取结果时同样要用到。  

3，[获取结果] POST方式发送到https://asr.waiyutong.org/Mp3/recognize.html ，发送任务id（第一步获取到的）和音频文件名（第二部获取到的），例如`{"apiVersion":"1.0.1","id":"00000000001234567890","audio":["1234567890-1.mp3"],"type":"mp2"}`。接受到的返回数据（示例）为`
{
    "id": "00000000001234567890",
    "status": "1",
    "result": {
        "count": "1",
        "score": "98",//总得分
        "pid": "BE-A-1-1",
        "text": [
            {
                "score": "98",//总得分
                "sen": "hello world",//识别的语句
                "wordcount": "2",//单词数量
                "word": [
                    {
                        "score": "50",//单个单词得分
                        "content": "helo"得分的单词
                    },
                    {
                        "score": "48",//单个单词得分
                        "content": "world"//得分的单词
                    }
                ]
            }
        ]
    },
    "mp3": "https://data.waiyutong.org/asr/00000000001234567890.mp3",
    "server_no": "FE-A-000010"
}`  
  
`漏洞分析：在文件上传的页面，应当同步传入用户识别信息，例如手机号等，判断请求是否合法`
***后记:  
     本人不熟悉js,所以只写了几个php模拟以上请求，实现了添加任务和查询数据等功能，上传mp3的操作需要您自行实现。  
     以上所有数据仅供平台完善，优化。不可用作任何违法用途！  
***
